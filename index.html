<html>
<head>
  <meta charset=utf-8 />
  <title>CT Population 1900-2010</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

  <!-- Load Leaflet from CDN-->
  <link rel="stylesheet" href="http://cdn.jsdelivr.net/leaflet/0.7.3/leaflet.css" />
  <script src="http://cdn.jsdelivr.net/leaflet/0.7.3/leaflet.js"></script>

  <!-- Load Esri Leaflet from CDN -->
  <script src="http://cdn.jsdelivr.net/leaflet.esri/1.0.0/esri-leaflet.js"></script>

  <style type="text/css">
    body { margin:0; padding:0; }
    #map { position: absolute; top:0; bottom:0; right:0; left:0; }
    #infobox a{position:absolute;bottom:0;left:0;background:#fff;color:#000;text-decoration:none;font-family:arial,sans-serif;text-align:center;padding:1px 2px;font-size:12px;line-height:14px;display:inline-block;}
  </style>
</head>
<body>

<div id="map"></div>
	<!-- Infobox -->
<span id="infobox"><a href="http://github.com/jackdougherty/otl-historical-dot-density">1,000 people = 1 dot, randomly placed in town</a></span>

<script>
// see ArcGIS Online My Content for extent of tile layer
  var southWest = L.latLng(40.946250, -73.765968),
    northEast = L.latLng(42.046797, -71.771949),
    bounds = L.latLngBounds(southWest, northEast);

// set bounding box as maxBounds to restrict moving the map
var map = L.map('map', {
    maxBounds: bounds,
    maxZoom: 11, // given that dots are randomly placed, it doesn't make sense to allow zooming further than this level
    minZoom: 8  // check on smaller devices
});
// zoom the map to bounding box
  map.fitBounds(bounds);

  // set base layers, with the first to be added to the map on startup
  var baseLayers = {
    "1900": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1900/MapServer"
    }).addTo(map),
    "1910": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1910/MapServer"
    }),
    "1920": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1920/MapServer"
    }),
    "1930": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1930/MapServer"
    }),
    "1940": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1940/MapServer"
    }),
    "1950": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1950/MapServer"
    }),
    "1960": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1960/MapServer"
    }),
    "1970": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1970/MapServer"
    }),
    "1980": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1980/MapServer"
    }),
    "1990": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot1990/MapServer"
    }),
    "2000": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot2000/MapServer"
    }),
    "2010": L.esri.tiledMapLayer({
      url: "http://tiles.arcgis.com/tiles/5rblLCKLgS4Td60j/arcgis/rest/services/CTPopDot2010/MapServer"
    })  // no comma at the end of the list
  };

  var towns = L.esri.featureLayer({
      url: 'http://services1.arcgis.com/5rblLCKLgS4Td60j/arcgis/rest/services/CTtowns/FeatureServer/0',
      // simplifyFactor: 0.5,
      // precision: 5,
      style: function (feature) {
        return {color: 'red', weight: 0.5, fillOpacity: 0 };
      }
    }).addTo(map);
  towns.bindPopup(function (feature) {
    return L.Util.template('<p>{Town}</p>', feature.properties);
  });

  var overlays = {
    "CT towns": towns
  };
  L.control.layers(baseLayers, overlays, {collapsed: false}).addTo(map);  // collapsed false opens menu on startup

  // customize source link to your GitHub repo
       map.attributionControl
     .setPrefix('View <a href="http://github.com/jackdougherty/otl-historical-dot-density">open-source code on GitHub</a>, created with <a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>');

</script>

</body>
</html>
